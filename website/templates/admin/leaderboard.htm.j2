{% extends "base/body.htm.j2" %}


{% set page_title = "TCK - Leaderboard Admin" %}
{% set css_files = ["/css/admin-leaderboard.css"] %}
{% set current_page_url = "/admin/leaderboard" %}
{% set page_description = "" %}


{%- block content -%}
{% for i in leaderboard_items %}
    {% if i is none %}
        {% set i = {"index": loop.index0 + 1, "name": "", "amount": 0} %}
    {% endif %}
    <div class="leaderboard-item">
        <input
                type="hidden"
                name="item-data"
                data-index="{{ i.index }}"
                data-name="{{ i.name }}"
                data-amount="{{ i.amount }}" />
        <p>{{ i.index }}</p>
        <input
                type="text"
                name="name"
                value="{{ i.name }}"
                data-index="{{ i.index }}"
                placeholder="User's name"
                onchange="changeLeaderboardItemMeta('name', this)" />
        <input
                type="text"
                name="amount"
                step="0.01"
                value="{{ i.amount / 100 }}"
                data-index="{{ i.index }}"
                placeholder="Amount of money (USD)"
                onchange="changeLeaderboardItemMeta('amount', this)" />
    </div>
{% endfor %}

<script type="text/javascript">
function changeLeaderboardItemMeta(attr, inputNode) {
    let index = inputNode.dataset.index;
    let selector = `.leaderboard-item input[name="item-data"][data-index="${index}"]`;
    let meta = document.querySelector(selector);
    if(attr == 'amount') {
        meta.dataset[attr] = parseFloat(inputNode.value) * 100;
    }
    else {
        meta.dataset[attr] = inputNode.value;
    }
}
</script>
{%- endblock content -%}
